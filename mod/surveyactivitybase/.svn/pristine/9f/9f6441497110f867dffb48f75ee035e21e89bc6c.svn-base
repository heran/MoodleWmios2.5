<?php
use wmios\survey as survey;
require_once(dirname(__FILE__).'/../../../../config.php');
require_once(dirname(__FILE__).'/lib.php');
// Dataset definition 
$DataSet = new pData;
//图表数据
$DataSet->AddPoint(array(1,2,3,4,5,60,7,10,11,23,40),"Serie1");
$DataSet->AddPoint(array(4.0,4.1,4.2,4.3,4.4,4.5,4.6,4.7,4.8,4.9,5),"Serie2");

$DataSet->AddSerie();
$DataSet->SetAbsciseLabelSerie("Serie2");//设置X轴的值
//数据图例
//$DataSet->SetSerieName("人数","Serie1");
//$DataSet->SetSerieName("IBM","Serie2");
//$DataSet->SetSerieName("Google","Serie3");

//X轴
$DataSet->SetXAxisUnit("分");  
//Y轴
$DataSet->SetYAxisUnit("人");

// Initialise the graph
$Test = new pChart(700,230);
//设置图表尺寸、样式
$Test->setFontProperties("Fonts/simhei.ttf",8);
$Test->setGraphArea(50,30,680,200);
$Test->drawFilledRoundedRectangle(7,7,693,223,5,240,240,240);
$Test->drawRoundedRectangle(5,5,695,225,5,230,230,230);
$Test->drawGraphArea(255,255,255,TRUE);
//X轴、Y轴字体的颜色
$Test->drawScale($DataSet->GetData(),$DataSet->GetDataDescription(),SCALE_NORMAL,150,150,150,TRUE,0,2,TRUE);
$Test->drawGrid(4,TRUE,230,230,230,50);

// Draw the 0 line
$Test->setFontProperties("Fonts/simhei.ttf",6);
$Test->drawTreshold(0,143,55,72,TRUE,TRUE);

// Draw the bar graph
//柱状图要使用drawBarGraph()
$Test->drawBarGraph($DataSet->GetData(),$DataSet->GetDataDescription(),TRUE,80);


// Finish the graph
//制作图例、标题、字体等属性
$Test->setFontProperties("Fonts/simhei.ttf",10);
//$Test->drawLegend(596,150,$DataSet->GetDataDescription(),255,255,255);

//$Test->drawTitle(50,22,"Example",50,50,50,585);

//写值
$Test->writeValues($DataSet->GetData(),$DataSet->GetDataDescription(),array("Serie1"));


//生成图表
$imageFile = "bar.png";
$Test->Render($imageFile);
echo '<img src="'.$imageFile.'">';

